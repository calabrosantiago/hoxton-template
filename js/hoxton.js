!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).hoxton=t()}(this,(function(){"use strict";function e(e,a){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,o=!1,r=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(a.push(i.value),!t||a.length!==t);n=!0);}catch(e){o=!0,r=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw r}}return a}(e,a)||function(e,a){if(!e)return;if("string"==typeof e)return t(e,a);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,a)}(e,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var a=window,n=a.adkit,o=a.EB,r=a.EBG,i=a.Enabler,c=a.studio,d=a.dcFeedName,l=void 0===d?"hoxton":d;window.Creative||(window.Creative={});var u=function(e){var t=document.head,a=document.getElementById("hox-css");a||((a=document.createElement("style")).id="hox-css",t.appendChild(a));var n="";Object.keys(e.data).forEach((function(t){"css"===e.data[t].type&&(n+=" ".concat(e.data[t].value))})),a.innerHTML=n},s={data:{},dom:{},styles:{},metadata:{},ready:null,timeline:null,version:"0.3.12",backup:window.location.href.indexOf("hoxtonBackup")>=0,get:function(e){return s.data[e]&&s.data[e].value},id:function(e){return document.getElementById(e)},init:function(){},exit:function(e,t){var a=e;switch(("string"!=typeof a||!a&&"doubleclick_sv"===s.data.platform)&&(a="Exit"),a&&0===a.indexOf("http")&&console.warn("Error! The first param of a hoxton.exit should be an Exit name, not a url. Check your hoxton.exit implementation."),(t&&"string"!=typeof t||t&&0!==t.indexOf("http"))&&console.warn("Error! The Exit URL ".concat(t," used in hoxton.exit is not a valid URL. Check your hoxton.exit implementation.")),s.data.platform){case"opendc":window.dispatchEvent(new CustomEvent("lemonpi.interaction/click"));break;case"sizmek":window.EB&&window.EB.clickthrough();break;case"sizmek_sv":n.clickThrough();break;case"doubleclick":case"doubleclick_sv":i&&(t?i.exitOverride(a,t):i.exit(a));break;case"generic":t&&(console.warn("Ignoring clickTag and using custom url specified by hoxton.exit()"),window.open(t)),window.open(window.clickTag);break;default:t&&(console.warn("Ignoring clickTag and using custom url specified by hoxton.exit()"),window.open(t)),window.open(window.clickTag)}},setState:function(e){if("metadata"===e.type)return s.metadata[e.name]=e.value,void(s.data.metadata[e.name]=e.value);s.data[e.name]=e,Array.isArray(e.value)&&e.value.forEach((function(t){t.selected&&(s.data[e.name].selected=t.value)})),u(s)},getState:function(e){if(0===Object.keys(s.data).length)return console.warn("hoxton.js: getState called before DOM ready"),{};var t=e||{};return Object.keys(s.data).forEach((function(a){e&&e[a]&&console.warn('hoxton.js: "'.concat(a,'" already exists on supplied getState object, and has been overwritten')),t[a]=s.data[a].selected||s.data[a].value||s.data[a],""===s.data[a].value&&(t[a]="")})),t}},f=function(){Object.keys(s.data).forEach((function(e){switch(s.data[e].type){case"image":!function(e,t){var a=document.querySelector("#".concat(e));if(a)switch(s.dom[e]=a,a.tagName){case"DIV":a.style.background="url(".concat(t.value,")");break;case"IMG":a.src=t.value;break;default:a.src=t.value}}(e,s.data[e]);break;case"backgroundImage":t=e,a=s.data[e],(n=document.querySelector("#".concat(t)))&&(s.dom[t]=n,n.style.background="url(".concat(a.value,")"));break;case"video":!function(e,t){var a=document.querySelector("#".concat(e));if(a)switch(s.dom[e]=a,a.tagName){case"VIDEO":a.src=t.value,a.load();break;case"TRACK":a.src=t.value;break;default:console.warn("Hoxton.js: Error adding video",t)}}(e,s.data[e]);break;case"text":!function(e,t){var a=document.querySelector("#".concat(e));a&&(s.dom[e]=a,a.innerHTML=t.value)}(e,s.data[e]);break;case"array":Array.isArray(s.data[e].value)?s.data[e].value.forEach((function(t){t.selected&&(s.data[e].selected=t.value)})):s.data[e].selected=s.data[e].value}var t,a,n;u(s)})),document.body.style.display="block",document.body.dispatchEvent(s.ready),s.isInitialized&&"function"==typeof s.isInitialized?s.isInitialized():console.warn("Could not find an init function to call after preload. Set one with: hoxton.isInitialized = myFunction")},m=function(e){return new Promise((function(t){var a=new Image;a.onload=function(){return t(a)},a.onerror=function(n){console.warn("Failed Preload for src: ".concat(e)),console.error(n),t(a)},a.src=e}))},y=function(){var e=[];Object.keys(s.data).forEach((function(t){"image"===s.data[t].type&&s.data[t].value.match(/[^/]+(jpg|png|gif)$/)&&e.push(s.data[t].value)})),function(e){return Promise.all(e.map(m))}(e).then((function(){return f()})).catch((function(e){return console.error("Failed Preload",e)}))},v=function(){switch(s.data.platform){case"opendc":window.lemonpi.subscribe((function(e){Object.keys(s.data).forEach((function(t){s.data[t].type&&(s.data[t].value=e[t].value)}))})),y();break;case"sizmek_sv":Object.keys(s.data).forEach((function(e){s.data[e].type&&(s.data[e].value=n.getSVData(e))})),y();break;case"doubleclick_sv":var e={};Object.keys(s.data).forEach((function(t){switch(s.data[t].type){case"image":e[t]={},e[t].Type="file",e[t].Url=s.data[t].value;break;case"text":"exiturl"===t.toLowerCase()?(e[t]={},e[t].Url=s.data[t].value):e[t]=s.data[t].value}})),i.setDevDynamicContent((r=[e],(o=l)in(a={})?Object.defineProperty(a,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[o]=r,a)),window.dynamicContent||console.warn("dynamicContent not set by Enabler");var t=window.dynamicContent.hoxton[0];t||console.warn("dynamicData not set by Enabler"),Object.keys(t).forEach((function(e){s.data[e]&&(s.data[e].value||""===s.data[e].value)?s.data[e].value=t[e].Url?t[e].Url:t[e]:s.metadata[e]=t[e].Url?t[e].Url:t[e]})),t.hoxtonSettings&&(s.styles=t.hoxtonSettings)}var a,o,r;y()},h=function(){var e=window.self!==window.top;return"file:"===window.location.protocol&&!e};return window.addEventListener("load",(function(){if(s.timeline?window.Creative.tl=s.timeline:console.warn("hoxton.js: A Greensock Timeline was not supplied to Hoxton. Set with hoxton.timeline = myTimeline"),document.body.style.display="none","function"==typeof Event?s.ready=new Event("hoxton-ready"):(s.ready=document.createEvent("Event"),s.ready.initEvent("hoxton-ready",!0,!0)),s.data=function(t){var a=e(document.getElementsByTagName(t),1)[0];if(!a)return{error:"No Hoxton Tag Detected"};var n=a.getAttribute("data");try{return JSON.parse(n)}catch(e){}try{return JSON.parse(decodeURIComponent(unescape(n)))}catch(e){return{error:e}}}("hoxton"),s.data.metadata&&(s.metadata=s.data.metadata),h())return console.log("Local load detected. Skipping Ad Server specific detection."),function(){if(h()){var e=document.createElement("iframe");return e.style.width="".concat(s.data.adSize.width,"px"),e.style.height="".concat(s.data.adSize.height,"px"),e.style.border="0",e.src="index.html",document.body.innerHTML="",document.body.appendChild(e),!1}}(),void(document.body.style.display="block");switch(s.data.platform){case"sizmek":o.isInitialized()?y():o.addEventListener(r.EventName.EB_INITIALIZED,y());break;case"sizmek_sv":{function t(){v()}n.onReady(t);break}case"doubleclick":case"doubleclick_sv":i.isInitialized()?v():i.addEventListener(c.events.StudioEvent.INIT,(function(){return i.isPageLoaded()?v():i.addEventListener(c.events.StudioEvent.PAGE_LOADED,v)}));break;default:y()}}),!1),s}));
